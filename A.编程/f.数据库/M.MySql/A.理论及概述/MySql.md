# 1.概述





# 2.DDL



# 3.增





# 4.删



# 5.改



# 7.查



# 8.视图

## 1.1概述

###  1.1什么是视图

视图是虚拟的表，与包含数据的表不一样，视图只包含使用动态检查数据的查询。

视图为虚拟表。

它们包含的不是数据而是根据需要检索数据的查询。视图提供了一种MySQL的SELECT语句层次的封装，可用来简化数据处理以及重新格式化基础数据或保护基础数据。





###  1.2为什么使用视图

a.重用SQL语句

b.简化复杂的SQL操作，在编写查询后，可以方便的重用他而不必知道他的基本查询细节

c.使用表的组成部分而不是整个表

d.保护数据，可以给用户表特定部分的访问权，而不是表全部的访问权

e.更改数据表示格式，视图可以返回与底层表的表示和格式不同的数据





###  1.3 性能问题

因为试图不包含数据，所以每次使用视图时，都必须处理查询执行时所需的任一个检索。

如果你用多个联结和过滤创建了复杂的视图或嵌套了视图，可能回发现性能下降的很厉害，因此，在部署使用了大量视图的应用前，应该进行测试。



###  1.4 视图的规则和限制

1.与表一样，视图必须唯一命名

2.对于可以创建的视图数目没有限制

3.为了创建视图，必须具有足够的访问权限。这些权限通常有数据库管理人员授予

4.视图可以嵌套，即可以利用从其他视图中检索数据的查询来构造一个视图

5.  order By  可以用在视图中，但如果从该视图检索数据Select 中也含有 order by ,那么该视图中的order by 将被覆盖

6.视图不能索引，也不能有关联的触发器或默认值

7.视图可以和表一起使用。例如，编写一条连接表和视图的select语句。



##  1.2 操作

### 1.视图创建语句

​	CREATE VIEW  视图名称   AS   查询语句；

### 2.查看创建视图的语句

​	SHOW CREATE VIEW viewName;    

### 3.用DROP删除视图，其语法为 

​	DROP  VIEW  viewName;

### 4.更新视图时

可以先用DROP再用CREATE，也可以直接用CREATE OR REPLACE VIEW.

如果要更新的视图不存在，则第2条更新语句会创建一个试图；

如果要更新的试图存在，则第2条更新语句会替换原有试图；

```
CREATE OR REPLACE VIEW 
视图名称
AS
SELECT column_name(s) FROM table_name WHERE condition
```



注意：

​	不是所有的视图都可以更新，基本上可以说，如果MySQL不能正确地确定被更新的基数据，则不允许更新（包括插入和删除）。

这实际上意味着，如果视图定义中有以下操作，则不能进行视图的更新：

- 分组 （使用GROUP BY 和 having ）
- 联结
- 子查询
- 并
- 聚集函数 （Min()、Count()、Sum()等）
- DISTINCT
- 导出(计算)列



# 9.存储过程

## 9.1 概述

​	MySQL5 添加了对存储过程的支持，因此，本章内容适用于MYSQL5及以后的版本。

​	存储过程简单来说，就是为以后的使用而保存的一条或多条MySQL语句的集合。

​    可将其视为批文件，虽然它们的作用不仅限于批处理。 

​	

### 9.1.1 为什么要使用存储过程

​	1.通过把处理封装在容易使用的单元中，简化复杂的操作。 （简化）

​	2.由于不要求反复建立一系列处理步骤，这保证了数据的完整性。如果所有开发人员和应用程序都使用同一（试验和测试）存储过程，则所使用的代码都是相同的。  （安全）

​	3.简化对变动的管理。如果表名、列名或业务逻辑（或别的内容）有变化，只需要更改存储过程的代码。使用它的人员甚至不需要 知道这些变化。 （高效）



### 9.1.2 缺陷

​	1.存储过程的编写比基本SQL语句复杂，编写存储过程需要更高的技能，更丰富的经验。

​	2.可能不是每个人都有创建 存储过程 的安全访问权限。许多数据库管理员限制存储过程的创建权限，允许用户使用存储过程，但不与允许他们创建过程。





## 9.2 使用

### 9.2.1 执行存储过程 

MySQL执行存储过程的语句为 CALL，CALL接受存储过程的名字以及需要传递给它的任意参数。

```sql
CALL  存储过程名(@参数名,@参数名...);
```

存储过程可以显示结果，也可以不显示结果。具体看如何定义的存储过程。



### 9.2.2 创建存储过程 

```
CREATE PROCEDURE 存储过称名()
BEGIN
	SELECT avg(prod_price) as priceaverage from products;
	...[其他SQL语句]
END;
```

BEGIN和END语句用来限定存储过称体。

<<<<<<< HEAD
```sql
CREATE VIEW viewName as 

```

2.查看创建视图的语句
=======
>>>>>>> 329db3e2060aa09191e6f5ec0b6a178132a5b091


### 9.2.3 删除存储过程

### 9.2.4 带参存储过程

<<<<<<< HEAD
4.更新视图时，可以先用DROP再用CREATE ,也可以直接用CREATE OR REPLACE VIEW。如果要更新的视图不存在，则第2条更新语句会创建一个视图;如果要更新的视图存在，则第2条更新语句会替换原有视图。

TODO待续；
=======
### 9.2.5 建立智能存储过程
>>>>>>> 329db3e2060aa09191e6f5ec0b6a178132a5b091
